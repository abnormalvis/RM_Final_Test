<launch>
  <!-- Launch the chassis controller -->
  <node name="control_node" pkg="sentry_chassis_controller" type="wheel_controller_node" output="screen" >
    <!-- Load the joint_state_controller -->
    <rosparam param="hardware_interface_type">robot</rosparam>
  </node>

  <!-- Load the controllers -->
  <node name="rosparam" pkg="rosparam" type="rosparam"
        args="load $(find sentry_chassis_controller)/config/wheel_control.yaml" / >

  <!-- Joint State Publisher -->
  <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher" >
    <param name="use_gui" value="false" / >
  </node>

  <!-- Robot State Publisher -->
  <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" / >

  <!-- Forward Kinematics Node for TF -->
  <node name="forward_kinematics" pkg="sentry_chassis_controller" type="forward_kinematics_node" output="screen" >
    <param name="publish_rate" value="50.0" / >
    <param name="robot_base_frame" value="base_link" / >
    <param name="odom_frame" value="odom" / >
  </node>

  <!-- Spawner for controllers -->
  <node name="controller_spawner" pkg="controller_manager" type="spawner"
        args="joint_state_controller wheel_pid_controller" / >

  <!-- Optimized Keyboard Control Node (new version) -->
  <node name="sentry_control_key_optimized" pkg="sentry_chassis_controller" type="sentry_control_key_optimized" output="screen" >
    <!-- TF-related parameters (read by forward_kinematics and teleop) -->
    <param name="robot_base_frame" value="base_link" / >
    <param name="odom_frame" value="odom" / >
    <!-- Main teleop parameters -->
    <param name="field_centric" value="true" / >
    <param name="vel_scale_linear" value="1.0" / >
    <param name="vel_scale_angular" value="1.0" / >
    <param name="vel_scale_smart_linear" value="1.2" / >
    <param name="vel_scale_smart_angular" value="3.0" / >
    <!-- Optional: avoid publishing zero on no input (useful for autonomy tests) -->
    <param name="publish_zero_when_idle" value="true" / >
  </node>

  <!-- Optional: rviz for visualization -->
  <!-- <node name="rviz" pkg="rviz" type="rviz" args="-d $(find sentry_chassis_controller)/config/sentry_rviz.rviz" / > -->
</launch>